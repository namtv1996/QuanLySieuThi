angular.module("tiktak").controller("loginController", ["$scope", "loginService", "$injector", "notificationService", "apiService", function (e, t, a, i, n) { e.loginData = { userName: "", password: "", useRefreshTokens: !0 }; var o = o, r = ""; function o() { $(document).ready(function () { $(location).attr("href"); for (var t = window.location.href.substring(7), o = 0; o < t.length && ":" != t[o]; o++) r += t[o]; n.get("api/ManageStore/getbynamestore?key=" + r, null, function (t) { if (0 == t.data.length) a.get("$state").go("notification"); else { e.dateTime = t.data[0].Expirydate; var i, n = e.dateTime.substring(8, 10); i = e.dateTime.substring(5, 7) + "/" + n + "/" + e.dateTime.substring(0, 4); var o = new Date, r = new Date(i), l = Math.abs(r.getTime() - o.getTime()), s = Math.ceil(l / 864e5); e.showdateend = s, r.getTime() <= o.getTime() && (window.location = "http://" + t.data[0].StoreName + ".tiktac.vn/MailHelper/MailHelper") } }, function (e) { i.displayError(e.data) }) }) } e.loginSubmit = function () { t.login(e.loginData).then(function (t) { null != t ? i.displayError(t.data.error_description) : (a.get("$state").go("home"), i.displayInfo("Xin chào " + e.loginData.userName)) }) }, o() }]);